<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting the devices location | Makerspace</title>
    <meta name="description" content="A resource/code reference for Makerspace Students">
    
    
    <link rel="preload" href="/makerspace/assets/css/0.styles.540581a7.css" as="style"><link rel="preload" href="/makerspace/assets/js/app.debd2f8d.js" as="script"><link rel="preload" href="/makerspace/assets/js/2.bea4a480.js" as="script"><link rel="preload" href="/makerspace/assets/js/6.53284d11.js" as="script"><link rel="prefetch" href="/makerspace/assets/js/10.699443e1.js"><link rel="prefetch" href="/makerspace/assets/js/11.41049e84.js"><link rel="prefetch" href="/makerspace/assets/js/12.671333a8.js"><link rel="prefetch" href="/makerspace/assets/js/13.6ba2dbe7.js"><link rel="prefetch" href="/makerspace/assets/js/14.a50c9fc8.js"><link rel="prefetch" href="/makerspace/assets/js/15.d6f48d3b.js"><link rel="prefetch" href="/makerspace/assets/js/16.ae199350.js"><link rel="prefetch" href="/makerspace/assets/js/17.6ca45d62.js"><link rel="prefetch" href="/makerspace/assets/js/18.c9dfb02d.js"><link rel="prefetch" href="/makerspace/assets/js/19.2a604709.js"><link rel="prefetch" href="/makerspace/assets/js/20.d4b160a3.js"><link rel="prefetch" href="/makerspace/assets/js/21.13c1f42e.js"><link rel="prefetch" href="/makerspace/assets/js/22.0fce7d9c.js"><link rel="prefetch" href="/makerspace/assets/js/23.13bcb06d.js"><link rel="prefetch" href="/makerspace/assets/js/24.bc10ba95.js"><link rel="prefetch" href="/makerspace/assets/js/25.e21cbaf1.js"><link rel="prefetch" href="/makerspace/assets/js/26.cf6f72b5.js"><link rel="prefetch" href="/makerspace/assets/js/3.1398b66e.js"><link rel="prefetch" href="/makerspace/assets/js/4.323a5bf8.js"><link rel="prefetch" href="/makerspace/assets/js/5.367d6021.js"><link rel="prefetch" href="/makerspace/assets/js/7.230cb609.js"><link rel="prefetch" href="/makerspace/assets/js/8.b0d3b231.js"><link rel="prefetch" href="/makerspace/assets/js/9.bf962eeb.js">
    <link rel="stylesheet" href="/makerspace/assets/css/0.styles.540581a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/makerspace/" class="home-link router-link-active"><!----> <span class="site-name">Makerspace</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/makerspace/" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/makerspace/programming-101/" class="sidebar-heading clickable"><span>Programming 101</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/makerspace/game-dev-resources/" class="sidebar-heading clickable"><span>Game Dev Resources</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/makerspace/kotlin/" class="sidebar-heading clickable"><span>Kotlin</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/makerspace/android/" class="sidebar-heading clickable router-link-active open"><span>Android</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/makerspace/android/weather/" class="sidebar-heading clickable router-link-active open"><span>Weather App</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/makerspace/android/weather/" class="sidebar-link">Android Weather App</a></li><li><a href="/makerspace/android/weather/start/" class="sidebar-link">Creating a new project</a></li><li><a href="/makerspace/android/weather/mvvm/" class="sidebar-link">MVVM</a></li><li><a href="/makerspace/android/weather/location/" class="active sidebar-link">Getting the devices location</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#permissions-and-location" class="sidebar-link">Permissions and location</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#asking-the-user-for-permission" class="sidebar-link">Asking the user for permission</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#onrequestpermissionsresult" class="sidebar-link">onRequestPermissionsResult</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#showlocationrequestui" class="sidebar-link">showLocationRequestUI()</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#google-play-services" class="sidebar-link">Google Play Services</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#fusedlocationproviderclient" class="sidebar-link">FusedLocationProviderClient</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#getlocation" class="sidebar-link">getLocation()</a></li><li class="sidebar-sub-header"><a href="/makerspace/android/weather/location/#using-the-users-location" class="sidebar-link">Using the users location</a></li></ul></li><li><a href="/makerspace/android/weather/git/" class="sidebar-link">Git Integration</a></li><li><a href="/makerspace/android/weather/forecast/" class="sidebar-link">Getting the forecast</a></li><li><a href="/makerspace/android/weather/more-views/" class="sidebar-link">Adding More Data</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-the-devices-location"><a href="#getting-the-devices-location" aria-hidden="true" class="header-anchor">#</a> Getting the devices location</h1> <p>In order to get the weather at the devices current location, we first need to get the location itself. Before we do that, we need to give our device persmission to use location data at all.</p> <h2 id="permissions-and-location"><a href="#permissions-and-location" aria-hidden="true" class="header-anchor">#</a> Permissions and location</h2> <p>Permissions are Android's way of telling users what features of your device an app wants to use. If an app wants to access location data, it has to do 2 things.</p> <ol><li><p>Declare that it wants to use <code>ACCESS_COARSE_LOCATION</code> and/or <code>ACCESS_FINE_LOCATION</code> in the <code>AndroidManifest.xml</code>.</p></li> <li><p>Request permission from the user directly before using the location data for the first time.</p></li></ol> <p>Lets tackle the first thing on our todo list. Add the <code>ACCESS_COARSE_LOCATION</code> permission to the <code>manifest</code> block of <code>AndroidManifest.xml</code> using the <code>&lt;uses-permission&gt;</code> tag.</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.example.weatherapp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_COARSE_LOCATION<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- application block... --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="note"><p>The <code>ACCESS_COARSE_LOCATION</code> permission is used for city block level location data. You need to use <code>ACCESS_FINE_LOCATION</code> if you want to get the users exact location. For weather, we don't really need much precision, so <code>ACCESS_COARSE_LOCATION</code> is just fine. You can check out more in the <a href="https://developer.android.com/training/location/permissions" target="_blank" rel="noopener noreferrer">docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h2 id="asking-the-user-for-permission"><a href="#asking-the-user-for-permission" aria-hidden="true" class="header-anchor">#</a> Asking the user for permission</h2> <p>Step 2 on our todo list requires some actual code. In our <code>MainActivity</code>, in the <code>onCreate()</code> function, we need to check if our user has already given us permission to use location data.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>weatherapp

<span class="token keyword">import</span> android<span class="token punctuation">.</span>Manifest <span class="token comment">// NEW!</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>pm<span class="token punctuation">.</span>PackageManager <span class="token comment">// NEW!</span>
<span class="token comment">// ...</span>
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContextCompat <span class="token comment">// NEW!</span>
<span class="token comment">// ...</span>

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        <span class="token comment">// NEW!</span>
        <span class="token keyword">when</span> <span class="token punctuation">{</span>
            ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION
            <span class="token punctuation">)</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="note"><p>We used <code>ContextCompat.checkSelfPermission()</code>, but we could have used just <code>checkSelfPermission()</code>. Doing this however would limit what devices could use our app as <code>checkSelfPermission()</code> is a newer method that older versions of Android don't have. <code>ContextCompat</code> bridges the gap for us so we don't run into that issue.</p></div> <p>The <code>getLocation()</code> method doesn't exist yet. We'll create it in <code>MainActivity</code>.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If the user hasn't given us permission to use location data, we need to check to see if we've already asked them for it.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>weatherapp

<span class="token keyword">import</span> android<span class="token punctuation">.</span>Manifest
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>pm<span class="token punctuation">.</span>PackageManager
<span class="token comment">// ...</span>
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>app<span class="token punctuation">.</span>ActivityCompat <span class="token comment">// NEW!</span>
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContextCompat
<span class="token comment">// ...</span>

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        <span class="token keyword">when</span> <span class="token punctuation">{</span>
            ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION
            <span class="token punctuation">)</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// NEW!</span>
            ActivityCompat<span class="token punctuation">.</span><span class="token function">shouldShowRequestPermissionRationale</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION
            <span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">showLocationRequestUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="note"><p><code>ActivityCompat</code> serves a similar purpose to <code>ContextCompat</code>, but specifically for classes that inherit from <code>Activity</code>. <code>MainActivity</code> is both a <code>Context</code> and an <code>Activity</code>.</p></div> <p>Like <code>getLocation()</code>, <code>showLocationRequestUI()</code> doesn't exist yet, so we'll create it below.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token comment">// NEW!</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">showLocationRequestUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, we need to handle the case that the user hasn't given us permission, but we don't need to tell them why we need permission.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>weatherapp

<span class="token keyword">import</span> android<span class="token punctuation">.</span>Manifest
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>pm<span class="token punctuation">.</span>PackageManager
<span class="token comment">// ...</span>
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>app<span class="token punctuation">.</span>ActivityCompat
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContextCompat
<span class="token comment">// ...</span>

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        <span class="token keyword">when</span> <span class="token punctuation">{</span>
            ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION
            <span class="token punctuation">)</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            ActivityCompat<span class="token punctuation">.</span><span class="token function">shouldShowRequestPermissionRationale</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION
            <span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">showLocationRequestUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// NEW!</span>
            <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">requestLocationPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Yet again, <code>requestLocationPermission()</code> doesn't exist yet. This time it will actually do something.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">requestLocationPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ActivityCompat<span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span>
            <span class="token keyword">this</span><span class="token punctuation">,</span>
            <span class="token function">arrayOf</span><span class="token punctuation">(</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION<span class="token punctuation">)</span><span class="token punctuation">,</span>
            LOCATION_REQUEST_CODE
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>ActivityCompat.requestPermissions()</code> method takes 3 parameters.</p> <ol><li>The activity the request is being preformed on in our case <code>this</code> (referring to <code>MainActivity</code>).</li> <li>An array of permission strings that we want the user to give us access to.</li> <li>An <code>Int</code> request code that we'll use to see if our request was granted.</li></ol> <p>The <code>LOCATION_REQUEST_CODE</code> value is a custom value that we are going to create. Above <code>class MainActivity</code> add the following.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">const</span> <span class="token keyword">val</span> LOCATION_REQUEST_CODE <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div><div class="note"><p>We could just use <code>0</code> in <code>requestPermissions()</code>, but using a named value will be easier when we get our permissions result back.</p></div> <h2 id="onrequestpermissionsresult"><a href="#onrequestpermissionsresult" aria-hidden="true" class="header-anchor">#</a> onRequestPermissionsResult</h2> <p>Once we send of a permissions request, eventually Android will call the <code>onRequestPermissionsResult()</code> method on our <code>MainActivity</code>. We're not currently overriding <code>onRequestPermissionsResult()</code>, so we'll need to do that to actual see the result. Press <code>Ctrl + O</code>, find <code>onRequestPermissionsResult</code> and once it generates, modify it to check for our permission.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>
    requestCode<span class="token operator">:</span> Int<span class="token punctuation">,</span>
    permissions<span class="token operator">:</span> Array<span class="token operator">&lt;</span><span class="token keyword">out</span> String<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    grantResults<span class="token operator">:</span> IntArray
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">when</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        LOCATION_REQUEST_CODE <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// Check if we have permission</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>grantResults<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> grantResults<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">showLocationDeniedUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>when</code> statement (check out <a href="https://kotlinlang.org/docs/reference/control-flow.html#when-expression" target="_blank" rel="noopener noreferrer">the docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to learn more about <code>when</code> statments), checks the <code>requestCode</code> parameter to see if it matchs a certain criteria.</p> <div class="note"><p>You can see we're using the <code>LOCATION_REQUEST_CODE</code> from earlier. If we needed to request multiple permissions, we would need to create multiple request codes.</p></div> <p>If the <code>requestCode</code> is the same as our <code>LOCATION_REQUEST_CODE</code>, we can check to see if our permission is granted.</p> <p>The <code>grantResults</code> is an <a href="https://kotlinlang.org/docs/reference/basic-types.html#arrays" target="_blank" rel="noopener noreferrer">array<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of <code>Int</code>s. These <code>Int</code>s will be values from <code>PackageManager</code>. The only value we care about though is <code>PackageManager.PERMISSION_GRANTED</code>.</p> <p>We haven't created <code>showLocationDeniedUI()</code> so create below the others.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">showLocationDeniedUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="showlocationrequestui"><a href="#showlocationrequestui" aria-hidden="true" class="header-anchor">#</a> showLocationRequestUI()</h2> <p>This method should tell to user <em>why</em> we need permission to use their location, and give them the option to accept  or deny our request. There are many ways make this kind of UI, but for simplicities sake, we're going to use an <code>AlertDialog</code>. An <code>AlertDialog</code> is a popup that has a title, message, and some buttons that the user can interact with to do different things in our app. We're going to create and display an <code>AlertDialog</code> in <code>showLocationRequestUI()</code>.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// ...</span>
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AlertDialog
<span class="token comment">// ...</span>

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">showLocationRequestUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        AlertDialog<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Please enable location&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token string">&quot;We need location data to get the weather in your area&quot;</span><span class="token punctuation">)</span>
            <span class="token comment">// This will be called when the user clicks off the alert dialog</span>
            <span class="token punctuation">.</span><span class="token function">setOnCancelListener</span> <span class="token punctuation">{</span>
                <span class="token function">showLocationDeniedUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// This will create a Cancel button</span>
            <span class="token punctuation">.</span><span class="token function">setNegativeButton</span><span class="token punctuation">(</span><span class="token string">&quot;Cancel&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _<span class="token punctuation">,</span> _ <span class="token operator">-&gt;</span>
                <span class="token function">showLocationDeniedUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// This will create an Ok button</span>
            <span class="token punctuation">.</span><span class="token function">setPositiveButton</span><span class="token punctuation">(</span><span class="token string">&quot;Ok&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _<span class="token punctuation">,</span> _ <span class="token operator">-&gt;</span>
                <span class="token function">requestLocationPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="note"><p>The <code>_, _ -&gt;</code> bit in <code>setNegativeButton()</code> and <code>setPositiveButton()</code> indicate that these lambdas normally take 2 parameters. We can use an <code>_</code> to ignore parameters in a lambda.</p></div> <div class="warning"><p>Make sure that you deny location access when you first run the app. <code>showLocationRequestUI()</code> will only run when <code>ActivityCompat.shouldShowRequestPermissionRationale()</code> is <code>true</code> which will only happen if the user has denied location data at least once.</p> <p>If you din't deny the permission, you can uninstall the app, or go into the app settings to remove the permission. Then you can run the app again.</p></div> <p>You should get something like this when the method is called.</p> <p><img src="/makerspace/assets/img/location-dialog.8b8b3373.png" alt=""></p> <p>Hitting the OK button will run <code>requestLocationPermission()</code>.</p> <p>Now that we have the users permission to access their location, let's actually get their location. We're going to need some things first though.</p> <h2 id="google-play-services"><a href="#google-play-services" aria-hidden="true" class="header-anchor">#</a> Google Play Services</h2> <p>The simplest way to get location data is through Google Play Services. We need to download them through Android Studio's SDK Manager.</p> <div class="note"><p>You can find the sdk manager by clicking the cube with a down arrow. You'll find it in the top left of the Android Studio window.</p> <p><img src="/makerspace/assets/img/sdk-manager-button.0114ee9b.png" alt=""></p> <p>You can also find it under <code>Tools | SDK Manager</code>.</p></div> <p>Once the SDK Manager is open, switch to the SDK Tools tab. Then check the Google Play services option.</p> <p><img src="/makerspace/assets/img/google-play-services.d237451a.png" alt=""></p> <p>Click OK once you've done that, and Android Studio will install Google Play services if it hasn't already.</p> <h2 id="fusedlocationproviderclient"><a href="#fusedlocationproviderclient" aria-hidden="true" class="header-anchor">#</a> FusedLocationProviderClient</h2> <p>One of the things Google Play Services provides, is a class called <a href="https://developers.google.com/android/reference/com/google/android/gms/location/FusedLocationProviderClient" target="_blank" rel="noopener noreferrer">FusedLocationProviderClient<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. We'll use this to get access to our location data. We need to add it to our <code>build.gradle</code> first.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>dependencies <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    implementation <span class="token string gstring">&quot;com.google.android.gms:play-services-location:17.0.0&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="note"><p>I used <a href="https://developers.google.com/android/guides/setup" target="_blank" rel="noopener noreferrer">https://developers.google.com/android/guides/setup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to find this dependencies, and you can find other Google Play Services dependencies there as well.</p></div> <p>Now we can use the <code>FusedLocationProviderClient</code> in our application. We're going to create a field on <code>MainActivity</code> to store our <code>fusedLocationProviderClient</code>, which will set in <code>onCreate()</code>.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// ...</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>android<span class="token punctuation">.</span>gms<span class="token punctuation">.</span>location<span class="token punctuation">.</span>FusedLocationProviderClient
<span class="token keyword">import</span> com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>android<span class="token punctuation">.</span>gms<span class="token punctuation">.</span>location<span class="token punctuation">.</span>LocationServices
<span class="token comment">// ...</span>

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">lateinit</span> <span class="token keyword">var</span> fusedLocationProviderClient<span class="token operator">:</span> FusedLocationProviderClient

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        fusedLocationProviderClient <span class="token operator">=</span> LocationServices<span class="token punctuation">.</span><span class="token function">getFusedLocationProviderClient</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="note"><p>We use a <code>lateinit var</code> because the <code>fusedLocationProviderClient</code> can change as the application is running. We could have just used a <code>var</code>, but Kotlin requires that all <code>var</code>s (and <code>val</code>s) be created with a value. That would mean we'd have to do something like this.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">var</span> fusedLocationProviderClient<span class="token operator">:</span> FusedLocationProviderClient<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>
</code></pre></div><p>This would require that we check if <code>fusedLocationProviderClient</code> is <code>null</code> everytime we tried to use it.</p></div> <p>We can now <strong>finally</strong> get our user's location.</p> <h2 id="getlocation"><a href="#getlocation" aria-hidden="true" class="header-anchor">#</a> getLocation()</h2> <p>Update the <code>getLocation()</code> method to as shown.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fusedLocationProviderClient<span class="token punctuation">.</span>lastLocation
        <span class="token punctuation">.</span><span class="token function">addOnSuccessListener</span> <span class="token punctuation">{</span> location <span class="token operator">-&gt;</span>
            <span class="token comment">// TODO</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">addOnFailureListener</span> <span class="token punctuation">{</span> 
            Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;Unable to retrieve users location&quot;</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Here we get the <code>lastLocation</code> from the <code>fusedLocationProviderClient</code>. The <code>lastLocation</code> is a <code>Task&lt;Location&gt;</code>. <code>Task&lt;*&gt;</code> values have a few methods on them that we can use to run code when the task is completed (or failed).</p> <p><code>addOnFailureListener()</code> will execute if the <code>lastLocation</code> task fails for whatever reason. We simply just display a message to the user that a failure occured.</p> <p><code>addOnSuccessListener()</code> takes in a lambda with one parameter: <code>location</code>. That's the location we need to tell our <code>WeatherViewModel</code> what location to use when it eventually gets the forecast. Move the <code>viewModel</code> code from <code>onCreate()</code> to here.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token punctuation">.</span><span class="token function">addOnSuccessListener</span> <span class="token punctuation">{</span> location <span class="token operator">-&gt;</span>
    <span class="token keyword">val</span> viewModel<span class="token operator">:</span> WeatherViewModel <span class="token keyword">by</span> <span class="token function">viewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    viewModel<span class="token punctuation">.</span><span class="token function">getForecast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Observer <span class="token punctuation">{</span> forecast <span class="token operator">-&gt;</span>
            temperatureText<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token delimiter variable">${</span>forecast<span class="token punctuation">.</span>temperature<span class="token delimiter variable">}</span></span> F&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We need to change <code>getForecast()</code> to use our location.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">class</span> WeatherViewModel<span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">fun</span> <span class="token function">getForecast</span><span class="token punctuation">(</span>latitude<span class="token operator">:</span> Double<span class="token punctuation">,</span> longitude<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> LiveData<span class="token operator">&lt;</span>WeatherModel<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> result <span class="token operator">=</span> MutableLiveData<span class="token operator">&lt;</span>WeatherModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        result<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">WeatherModel</span><span class="token punctuation">(</span><span class="token number">82.0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="note"><p>We're using <code>latitude</code> and <code>longitude</code> seperately here, because we can create a <code>Location</code> object ourselves. If the user doesn't give us permission to use their location, it would be good for us to display some random location instead.</p></div> <p>With that in place we need to update our call as well</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token punctuation">.</span><span class="token function">addOnSuccessListener</span> <span class="token punctuation">{</span> location <span class="token operator">-&gt;</span>
    <span class="token keyword">val</span> viewModel<span class="token operator">:</span> WeatherViewModel <span class="token keyword">by</span> <span class="token function">viewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    viewModel<span class="token punctuation">.</span><span class="token function">getForecast</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> location<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span> <span class="token comment">// UPDATED!</span>
        <span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Observer <span class="token punctuation">{</span> forecast <span class="token operator">-&gt;</span>
            temperatureText<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token delimiter variable">${</span>forecast<span class="token punctuation">.</span>temperature<span class="token delimiter variable">}</span></span> F&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="using-the-users-location"><a href="#using-the-users-location" aria-hidden="true" class="header-anchor">#</a> Using the users location</h2> <p>We're going to save getting the actual forecast for next time, but for now let's return the user's <code>latitude</code> as the temperature value just so we can see things are working.</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">class</span> WeatherViewModel<span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">fun</span> <span class="token function">getForecast</span><span class="token punctuation">(</span>latitude<span class="token operator">:</span> Double<span class="token punctuation">,</span> longitude<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> LiveData<span class="token operator">&lt;</span>WeatherModel<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> result <span class="token operator">=</span> MutableLiveData<span class="token operator">&lt;</span>WeatherModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        result<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">WeatherModel</span><span class="token punctuation">(</span>latitude<span class="token punctuation">)</span> <span class="token comment">// UPDATED!</span>
        <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>With that you should have a long number for your temperature.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/makerspace/android/weather/mvvm/" class="prev">MVVM</a></span> <span class="next"><a href="/makerspace/android/weather/git/">Git Integration</a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/makerspace/assets/js/app.debd2f8d.js" defer></script><script src="/makerspace/assets/js/2.bea4a480.js" defer></script><script src="/makerspace/assets/js/6.53284d11.js" defer></script>
  </body>
</html>
